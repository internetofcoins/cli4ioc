require("./globals");fs=require("fs");path=require("path");storage=require("./storage");nacl=require("./crypto/nacl");crypto=require("crypto");LZString=require("./crypto/lz-string");Decimal=require("./crypto/decimal-light");Decimal.set({precision:64});UrlBase64=require("./crypto/urlbase64");hex2dec=require("./crypto/hex2dec");DJB2=require("./crypto/hashDJB2");sha256=require("./crypto/sha256");najax=require("najax");blessed=require("blessed");clipboardy=require("clipboardy");jsdom=require("jsdom");require("./hybriddcall");require("./transaction");UI.views={};require("./views/interface");require("./views/assets");UI.buttonfunc=require("./buttons");UI.modalfunc=require("./modal");var userid=process.env["CLI4IOC_USER"];var passwd=process.env["CLI4IOC_PASS"];function login(userid,passwd){if(typeof userid!=="undefined"&&typeof passwd!=="undefined"&&userid.length==16&&(passwd.length==16||passwd.length==48)){session_step=0;require("./login.js").login(userid,passwd);process.stdout.write(lang.viewLoginBusy);function sessionWait(){if(GL.session==false){process.stdout.write(".");setTimeout(sessionWait,1e3)}else{process.stdout.write(".\n");UI.interface()}}sessionWait()}else{console.error(lang.viewLoginNeedInfo)}}if(typeof userid!=="undefined"&&typeof passwd!=="undefined"){login(userid,passwd)}else{console.log(lang.viewLoginEnter);var stdio=require("stdio");consoleinput(lang.viewLoginUser,{capitalize:true},function(err,userid){consoleinput(lang.viewLoginPass,{password:true},function(err,passwd){login(userid,passwd)})})}function consoleinput(question,options,callback){if(typeof options==="function"){callback=options;options=null}if(!question){throw new Error("Prompt question is malformed. It must include at least a question text.")}var performQuestion=function(){var str=question;str+=": ";process.stdout.write(str)};process.stdin.setRawMode(true);process.stdin.resume();process.stdin.setEncoding("utf8");var listener=function(char){var key=char.charCodeAt(0);if(char===""){process.stdout.write("\n");process.exit()}else if(key===13){process.stdout.write("\n");process.stdin.removeListener("data",listener);process.stdin.pause();process.stdin.setRawMode(false);callback(false,result)}else if(key===127){process.stdout.write("\b \b");result=result.slice(0,-1)}else{if(char.match(/^[a-zA-Z0-9*]+$/)){if(typeof options.password!=="undefined"&&options.password){var out=Array(char.length+1).join("*");result=result+char}else if(typeof options.capitalize!=="undefined"&&options.capitalize){var out=char.toUpperCase();result=result+char.toUpperCase()}else{var out=char;result=result+char}process.stdout.write(out)}}};var result="";process.stdin.addListener("data",listener);performQuestion()}
